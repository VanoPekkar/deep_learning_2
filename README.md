# Глубокое обучение, кейс 2. Матчинг описания вакансий и резюме. Команда 31

## Содержание

- `models.ipynb` - ноутбук с тестированием моделей
- `app/my_app.py` - приложение для локального запуска
- `datasets` - папка с датасетами

## Данные

В качестве датасетов были выбраны данные с сайта HeadHunter: вакансии и резюме. Из вакансий использовались поля

- Ищет работу на должность,
- Город, переезд, командировки,
- Занятость,
- Последнее/нынешнее место работы,
- Последняя/нынешняя должность,
- Образование и ВУЗ

Остальные поля для задачи нам показались не релевантными. Из резюме использовалось только описание вакансии, переведенное из html в текст

## Процесс обучения

В качестве подхода для решении задачи был выбран следующий: текст вакансии и текст резюме превратить в два вектора-эмбеддинга и сравнить их с помощью косинусной близости (cosine similarity). Поскольку соответствующие друг другу вакансия и резюме будут иметь близкие эмбеддинги, то и метрика косинусной близости должна иметь большое значение

Для перевода текста в вектор тестировались следующие три подхода

1. Использовать модель [word2vec](https://radimrehurek.com/gensim/auto_examples/tutorials/run_word2vec.html): для каждого слова из текста вычислить вектор, затем усреднить
2. Использовать модель [doc2vec](https://radimrehurek.com/gensim/models/doc2vec.html)
3. Использовать предобученную текстовую модель. Мы выбрали gpt2, [предобученную на русских текстах](https://huggingface.co/ai-forever/rugpt3small_based_on_gpt2)

Для текстов проводился препроцессинг: токенизация, нормализация, исключение стоп-слов

## Результаты

Для тестирования выбранных методов вручную был собрана выборка из 100 пар резюме-вакансия: 10 блоков по 10 различных профессий. В терминах задачи ранжирования мы считаем резюме релевантным с точностью до профессии. Таким образом для каждой из 10 профессий было про 10 релевантных резюме. Далее была вычислена метрика map@k для k от 1 до 10

По результатам при всех k лучшей оказалась модель doc2vec

## Демонстрация

Для запуска демонстрационного интерфейса необходимо установить пакет gradio и выполнить команду `gradio app/my_app.py`. В интерфейсе по тексту вакансии можно получить топ-5 самых подходящих резюме из небольшой базы данных, которая хранится локально для демонстрации
